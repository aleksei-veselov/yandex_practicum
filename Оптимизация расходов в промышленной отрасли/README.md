# Предсказание температуры расплава стали для ООО «Так закаляем сталь»
# Цель проекта
Построение модели машинного обучения, которая предскажет температуру стали для оптимизации производственных расходов (потребление электроэнергии) на этапе обработки стали. 
# Описание этапа обработки
Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша. 

Из сплава выводится сера (десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — **изменяют её состав** — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (англ. **tribe**, «масса»).

Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.
Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. **slab**, «плита»).

# Итоговый вывод

**Выполнение плана**
Запланированные мероприятия выполнены в полном объеме.

**Описание сложностей проекта**

В ходе выполнения проекта встретились сложнасти с пониманием технологического процесса по изготовлению стали. 
В ходе встречи с представителем заказчика (тим-лидом) был детально проработанн технолгический процесс с детальным обзором технологических операций. Данных сведений было достаточно для понимания. 

**Описание шагов решения:**

**В ходе проведения исследовательского анализа и предобработки данных выполнены следующие шаги:**

- произведена загрузка данных;
- разработана ф-ия по проведению исследоваельского  анализа данных;
- проведен анализ данных, выявлены аномалии (выбросы) и составлены по каждому датасету планы проведения предобработки;
- выполнены все пункты планов по предобработке, среди которых можно выделить:
	- обработка аномалий и пропусков;
	- разработка новых признаков;
	- агрегирование данных по ключ;
	- выбор ключей в роле индекса.

**Подготовка данных к обучению:**

- провдено объединение всех датасетов за исключением df_bulk_time и df_wire_time;
- проведен анализ и предобработка объединенных данных;
- все признаки проверены на мультиколлениарность, среди высокококоррелирующих признаков удалены wire_8 и energy;
- все данные разделены на обучающуую и тестовую выборки в отношении 75/25(%);
- проведно масштабирование признаков с использованием StandardScaler для обучения линейных моделей;
- итоговоый перечень используемых для обучения признаков:  'full_power', 'heating_time', 'bulk_1', 'bulk_2', 'bulk_3', 'bulk_4', 'bulk_5', 'bulk_6', 'bulk_7', 'bulk_10', 'bulk_11', 'bulk_12', 'bulk_13', 'bulk_14', 'bulk_15', 'gas', 'wire_1', 'wire_2', 'wire_3', 'wire_4', 'wire_6', 'wire_9', 'temperature_start', 'temperature_end'.


**Обучение моделей:**

1) Для обучения были выбраны модели машинного обучения:
- Ridge;
- LGBMRegressor;
- RandomForestRegressor.

2) Подбор гиперпараметров осуществлялся при помощи RandomizedSearchCV и GridSearchCV.

3) Лучшее значение оцениваемой мерики показала модель RandomForestRegressor (MAE = 6.388673, перечень лучших гиперпараметров: 'n_estimators': 70, 'min_samples_split': 2, 'min_samples_leaf': 4 и 'max_depth': 18 ) и была выбрана для проведения оценки на тестовом наборе данных.

4) Произведена оценка важности признаков на которых строилось предсказание RandomForestRegressor. Среди наиболее значимых признаков: "temperature_start, time_heat, wire_1", т.е. температура в начале замера, время нагрева в секундах и первый проволочный материал для выполнения технологических операций.  

**Тестирование модели:**

Для проведения тестирования введена дополнительная метрика R2 и провдено сравнение с констатной моделью DummyRegressor.
В результате:
- значение MAE RandomForestRegressor на тестовой выборке: 6.004405247286704;
- значение R2 RandomForestRegressor на тестовой выборке: 0.40162866837615185;
- значение MAE DummyRegressor по медиане на тестовой выборке = 7.6. 

Значение метрики RandomForestRegressor лучше DummyRegressor на 1.6, следовательно можно сделать вывод о том, что модель  можно применять и запускать в промыщленную эксплуатацию.Также, заказчику стоит обратить пристальное внимание на перечень значимых признаков ,чтобы достигнуть цели по оптимизации производственных расходов на энергоресурсы.

*П р и м е ч а н и е: В ходе обучения и тестирования использовано констатное значение RANDOM_STATE = 280823.*
